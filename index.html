<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="theme-color" content="#0f1724">
<title>Study Arc ‚Äî Focus & Conquer</title>
<link rel="icon" href="icons/app-logo-192.png" type="image/png">
<link rel="manifest" href="manifest.json?v=3">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5520401672645952" crossorigin="anonymous"></script>

<style>
/* --- ORIGINAL PREMIUM CSS (Untouched) --- */
:root {
  --bg-gradient: linear-gradient(135deg, #0f1724 0%, #071633 100%);
  --glass-bg: rgba(255, 255, 255, 0.05);
  --glass-border: 1px solid rgba(255, 255, 255, 0.1);
  --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  --backdrop: blur(12px);
  --accent: #38bdf8;
  --accent-grad: linear-gradient(90deg, #38bdf8, #818cf8);
  --text: #ffffff;
  --text-muted: rgba(255, 255, 255, 0.6);
  --danger: #ef4444;
  --success: #10b981;
  --font-main: 'Inter', system-ui, -apple-system, sans-serif;
}

body.theme-sunset { --bg-gradient: linear-gradient(135deg, #4c1d95, #be185d); --accent: #fbbf24; --accent-grad: linear-gradient(90deg, #fbbf24, #f59e0b); }
body.theme-mint { --bg-gradient: linear-gradient(135deg, #064e3b, #065f46); --accent: #34d399; --accent-grad: linear-gradient(90deg, #34d399, #10b981); }

* { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
body { margin: 0; font-family: var(--font-main); background: var(--bg-gradient); color: var(--text); min-height: 100vh; overflow-x: hidden; }

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }

/* Layout */
.app-container { max-width: 1200px; margin: 0 auto; padding: 20px; display: grid; grid-template-columns: 280px 1fr; gap: 20px; height: 100vh; overflow: hidden; }

/* Glass Components */
.glass-panel {
  background: var(--glass-bg);
  backdrop-filter: var(--backdrop);
  -webkit-backdrop-filter: var(--backdrop);
  border: var(--glass-border);
  border-radius: 20px;
  box-shadow: var(--glass-shadow);
  padding: 20px;
  overflow-y: auto;
}

/* Sidebar */
.sidebar { display: flex; flex-direction: column; gap: 20px; height: 100%; }
.brand { font-size: 24px; font-weight: 800; background: var(--accent-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: -1px; }
.nav-item { padding: 12px; border-radius: 12px; cursor: pointer; transition: 0.3s; color: var(--text-muted); display: flex; align-items: center; gap: 10px; font-weight: 500; }
.nav-item:hover, .nav-item.active { background: rgba(255,255,255,0.1); color: var(--text); border-left: 4px solid var(--accent); }
.community-widget { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(6, 78, 59, 0.2)); padding: 15px; border-radius: 15px; border: 1px solid rgba(16, 185, 129, 0.3); font-size: 13px; animation: pulse 3s infinite; }
@keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);} 70% {box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);} 100% {box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);} }

/* Main Content */
.main-content { display: flex; flex-direction: column; gap: 20px; height: 100%; overflow-y: auto; }
.header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; }
.greeting h1 { margin: 0; font-size: 28px; }
.greeting p { margin: 5px 0 0; color: var(--text-muted); font-size: 14px; }

/* Cards & Stats */
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
.stat-card { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 16px; text-align: center; border: 1px solid rgba(255,255,255,0.05); position: relative; overflow: hidden; }
.stat-val { font-size: 28px; font-weight: 800; margin-top: 5px; color: var(--accent); }
.stat-label { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

/* Buttons & Inputs */
.btn { border: none; padding: 10px 20px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.2s; font-family: var(--font-main); }
.btn-primary { background: var(--accent-grad); color: #000; box-shadow: 0 4px 15px rgba(56, 189, 248, 0.3); }
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(56, 189, 248, 0.4); }
.btn-ghost { background: rgba(255,255,255,0.1); color: white; }
.input, .select { width: 100%; padding: 12px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: white; margin-bottom: 10px; font-family: var(--font-main); }
.input:focus { border-color: var(--accent); }

/* Task List */
.task-item { display: flex; align-items: center; justify-content: space-between; padding: 15px; margin-bottom: 10px; background: rgba(255,255,255,0.03); border-radius: 12px; border-left: 4px solid var(--accent); transition: 0.2s; }
.task-item:hover { transform: translateX(5px); background: rgba(255,255,255,0.06); }
.task-actions { display: flex; gap: 8px; }

/* SIMPLE FOCUS MODE OVERLAY (No Flip Clock) */
#focusOverlay { position: fixed; inset: 0; background: var(--bg-gradient); z-index: 999; display: flex; flex-direction: column; align-items: center; justify-content: center; transform: translateY(100%); transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
#focusOverlay.active { transform: translateY(0); }
.timer-huge { font-size: 80px; font-weight: 900; font-variant-numeric: tabular-nums; background: var(--accent-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

/* Modals & New Features */
.modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); z-index: 2000; display: flex; align-items: center; justify-content: center; }
.hidden { display: none !important; }

/* Exam Guide Cards */
.guide-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; margin-bottom: 15px; overflow: hidden; transition: 0.3s; }
.guide-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.02); }
.guide-content { padding: 0 15px; max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; color: var(--text-muted); font-size: 14px; line-height: 1.6; }
.guide-content.open { padding: 15px; max-height: 1000px; border-top: 1px solid rgba(255,255,255,0.1); }

/* Math Toolbar */
.math-toolbar { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 5px; }
.math-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 5px 12px; border-radius: 8px; cursor: pointer; font-size: 14px; }

/* Ads Area */
.ad-slot { width: 100%; text-align: center; margin: 10px 0; background: rgba(0,0,0,0.2); border-radius: 12px; overflow: hidden; min-height: 60px; display:flex; justify-content:center; align-items:center; flex-direction:column; }
.ad-label { font-size: 10px; color: #555; text-transform: uppercase; margin-bottom: 2px; }

@media (max-width: 768px) {
  .app-container { grid-template-columns: 1fr; height: auto; overflow: visible; padding: 10px; }
  .sidebar { display: none; }
  .timer-huge { font-size: 60px; }
}
</style>
</head>
<body class="theme-mint">

<canvas id="confetti-canvas" style="position:fixed; pointer-events:none; top:0; left:0; width:100%; height:100%; z-index:3000;"></canvas>

<div id="onboardingModal" class="modal hidden">
  <div class="glass-panel" style="max-width: 400px; text-align: center;">
    <h2>üöÄ Welcome to Study Arc</h2>
    <p>Let's personalize your experience.</p>
    <input id="obName" class="input" placeholder="Your Name (e.g., Abhinav)">
    <input id="obClass" class="input" placeholder="Target Exam (e.g., NEET)">
    <button class="btn btn-primary" style="width: 100%;" onclick="completeOnboarding()">Start Journey</button>
  </div>
</div>

<div id="focusOverlay">
  <div style="font-size: 16px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 20px;" id="focusSubjectDisplay">PHYSICS</div>
  
  <div class="timer-huge" id="focusTimerDisplay">00:00:00</div>
  
  <div style="margin-top: 20px; color: var(--text-muted); font-style: italic;">"Pain is temporary. Glory is forever."</div>
  
  <div style="display: flex; gap: 20px; margin-top: 40px;">
    <button class="btn" style="background: var(--danger); color: white;" onclick="exitFocus()">Stop Session</button>
  </div>
  <div style="margin-top: 20px; font-size: 10px; opacity: 0.5;">SCREEN WAKE LOCK ACTIVE üí°</div>
</div>

<div class="app-container">
  
  <aside class="sidebar glass-panel">
    <div class="brand">STUDY ARC</div>
    <nav style="display: flex; flex-direction: column; gap: 10px;">
      <div class="nav-item active" onclick="showSection('dashboard')">üìä Dashboard</div>
      <div class="nav-item" onclick="showSection('guide')">‚ÑπÔ∏è Exam Guide</div>
      <div class="nav-item" onclick="showSection('planner')">ü§ñ AI Planner</div>
      <div class="nav-item" onclick="showSection('notes')">üìù Scratchpad</div>
      <div class="nav-item" onclick="showSection('settings')">‚öôÔ∏è Settings</div>
    </nav>
    
    <div style="margin-top: auto;">
      <div class="community-widget">
        <div style="display:flex; align-items:center; gap:8px; margin-bottom:5px;">
          <div style="width:8px; height:8px; background:#10b981; border-radius:50%;"></div>
          <strong style="color:#10b981">LIVE NOW</strong>
        </div>
        <span id="liveUsers">1,240</span> students focusing.
      </div>
      
      <div class="ad-slot">
          <span class="ad-label">Sponsored</span>
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-5520401672645952"
               data-ad-slot="9706016855"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
      </div>
    </div>
  </aside>

  <main class="main-content">
    
    <div id="section-dashboard">
      <div class="header">
        <div class="greeting">
          <h1 id="userGreet">Hello, Student</h1>
          <p id="dateDisplay">Let's crush your goals today!</p>
        </div>
        <div class="glass-panel" style="padding: 8px 15px;">üî• <span id="streakDisplay">0</span> Day Streak</div>
      </div>

      <div class="ad-slot">
          <span class="ad-label">Sponsored</span>
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-5520401672645952"
               data-ad-slot="2938617898"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
      </div>

      <div class="glass-panel" style="margin-bottom: 20px; border: 1px solid var(--accent);">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
          <h3 style="margin:0;">‚ö° Quick Focus Session</h3>
        </div>
        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 10px; align-items: center;">
            <select id="quickSubject" class="input" style="margin:0;">
                <option value="Physics">Physics</option>
                <option value="Chemistry">Chemistry</option>
                <option value="Biology">Biology</option>
                <option value="Maths">Maths</option>
            </select>
            <input id="quickHrs" type="number" class="input" placeholder="Hr" value="0" style="margin:0;">
            <input id="quickMins" type="number" class="input" placeholder="Min" value="45" style="margin:0;">
            <button class="btn btn-primary" onclick="startQuickFocus()">START ‚ñ∂</button>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Studied Today</div>
          <div class="stat-val" id="todayTime">0h 0m</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Total Focus</div>
          <div class="stat-val" id="totalFocusTime">0h</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Subject Analysis</div>
          <div style="height: 100px; margin-top: 10px;">
            <canvas id="subjectChart"></canvas>
          </div>
        </div>
      </div>

      <div class="glass-panel" style="margin-top: 20px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
          <h3>‚úÖ Tasks Checklist</h3>
          <button class="btn btn-ghost" style="font-size:12px;" onclick="toggleTaskForm()">+ New Task</button>
        </div>
        
        <div id="addTaskForm" style="display:none; margin-bottom:15px; background:rgba(0,0,0,0.2); padding:10px; border-radius:10px;">
          <input id="newTaskName" class="input" placeholder="Task Name (e.g., Physics Chapter 1)">
          <div style="display:flex; gap:10px;">
            <button class="btn btn-primary" onclick="addTask()">Add Task</button>
          </div>
        </div>

        <div id="taskListContainer"></div>
      </div>
    </div>

    <div id="section-guide" class="hidden">
      <div class="glass-panel">
        <h2>‚ÑπÔ∏è Exam Success Hub</h2>
        <p style="color:var(--text-muted); margin-bottom:20px;">Detailed strategy, official links & free resources.</p>

        <div class="guide-card">
            <div class="guide-header" onclick="toggleGuide(this)">
                <strong>ü©∫ NEET (Medical) Full Roadmap</strong> <span>‚¨áÔ∏è</span>
            </div>
            <div class="guide-content">
                <h4 style="color:var(--accent); margin-top:10px;">Target: 680+ Marks</h4>
                <p>NEET ‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§ï‡§†‡§ø‡§® ‡§Æ‡•á‡§°‡§ø‡§ï‡§≤ ‡§è‡§Ç‡§ü‡•ç‡§∞‡•á‡§Ç‡§∏ ‡§π‡•à‡•§ ‡§Ø‡§π‡§æ‡§Å ‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è <strong>NCERT</strong> ‡§π‡•Ä ‡§∏‡§¨ ‡§ï‡•Å‡§õ ‡§π‡•à‡•§</p>
                
                <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px; margin:10px 0;">
                    <strong>üîó Official Links:</strong><br>
                    <a href="https://neet.nta.nic.in/" target="_blank" style="color:var(--accent);">üëâ Official NTA NEET Website</a><br>
                    <a href="https://ncert.nic.in/textbook.php" target="_blank" style="color:var(--accent);">üëâ Download NCERT PDFs</a>
                </div>

                <h5 style="margin-bottom:5px;">üß¨ Biology (360 Marks) - High Weightage</h5>
                <ul style="padding-left:20px; margin-top:5px;">
                    <li><strong>Genetics & Evolution:</strong> ‡§∏‡§¨‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§∏‡§µ‡§æ‡§≤ (15-18 Questions) ‡§Ø‡§π‡•Ä‡§Ç ‡§∏‡•á ‡§Ü‡§§‡•á ‡§π‡•à‡§Ç‡•§</li>
                    <li><strong>Ecology:</strong> ‡§Ü‡§∏‡§æ‡§® ‡§π‡•à ‡§™‡§∞ ‡§∏‡•ç‡§ï‡•ã‡§∞‡§ø‡§Ç‡§ó ‡§π‡•à‡•§</li>
                    <li><strong>Human Physiology:</strong> ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡•õ‡§∞‡•Ç‡§∞‡•Ä, ‡§°‡•â‡§ï‡•ç‡§ü‡§∞‡•Ä ‡§ï‡•Ä ‡§®‡•Ä‡§Ç‡§µ ‡§π‡•à‡•§</li>
                </ul>

                <h5 style="margin-bottom:5px;">üî≠ Physics - Easy Kill Topics</h5>
                <p>‡§Ö‡§ó‡§∞ ‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏ ‡§ï‡§Æ‡•õ‡•ã‡§∞ ‡§π‡•à, ‡§§‡•ã ‡§™‡§π‡§≤‡•á ‡§á‡§® ‡§ö‡•à‡§™‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§™‡§ï‡•ç‡§ï‡§æ ‡§ï‡§∞‡•á‡§Ç:</p>
                <ul style="padding-left:20px; margin-top:5px;">
                    <li>Semiconductors & Logic Gates (8-12 Marks ‡§™‡§ï‡•ç‡§ï‡•á)</li>
                    <li>Modern Physics (Atoms, Nuclei)</li>
                    <li>Units & Dimensions (‡§∏‡§¨‡§∏‡•á ‡§Ü‡§∏‡§æ‡§®)</li>
                </ul>
            </div>
        </div>

        <div class="guide-card">
            <div class="guide-header" onclick="toggleGuide(this)">
                <strong>üõ†Ô∏è JEE (Mains & Advanced) Guide</strong> <span>‚¨áÔ∏è</span>
            </div>
            <div class="guide-content">
                <h4 style="color:var(--accent); margin-top:10px;">Engineering Excellence</h4>
                <p>JEE ‡§Æ‡•á‡§Ç ‡§∏‡§µ‡§æ‡§≤ ‡§¶‡•ã‡§π‡§∞‡§æ‡§è ‡§®‡§π‡•Ä‡§Ç ‡§ú‡§æ‡§§‡•á, ‡§ï‡•â‡§®‡•ç‡§∏‡•á‡§™‡•ç‡§ü‡•ç‡§∏ ‡§¶‡•ã‡§π‡§∞‡§æ‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>

                <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px; margin:10px 0;">
                    <strong>üîó Important Resources:</strong><br>
                    <a href="https://jeemain.nta.nic.in/" target="_blank" style="color:var(--accent);">üëâ JEE Main Official Site</a><br>
                    <a href="https://nptel.ac.in/" target="_blank" style="color:var(--accent);">üëâ NPTEL (IIT Lectures Free)</a>
                </div>
                
                <h5 style="margin-bottom:5px;">üßÆ Maths - The Game Changer</h5>
                <ul style="padding-left:20px; margin-top:5px;">
                    <li><strong>Calculus:</strong> ‡§á‡§∏‡§ï‡§æ ‡§µ‡•á‡§ü‡•á‡§ú 30-35% ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§</li>
                    <li><strong>Vectors & 3D:</strong> ‡§µ‡§ø‡•õ‡•Å‡§Ö‡§≤‡§æ‡§á‡•õ‡•á‡§∂‡§® ‡•õ‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡•§</li>
                </ul>

                <h5 style="margin-bottom:5px;">üß™ Chemistry - Scoring Subject</h5>
                <p>‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§ï‡§Æ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§ï‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ï‡•ç‡§∏ ‡§≤‡§æ‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ NCERT ‡§ï‡•ã ‡§≤‡§æ‡§á‡§®-‡§¨‡§æ‡§Ø-‡§≤‡§æ‡§á‡§® ‡§∞‡§ü ‡§≤‡•á‡§Ç, ‡§ñ‡§æ‡§∏‡§ï‡§∞ Inorganic ‡§ï‡•á ‡§≤‡§ø‡§è‡•§</p>
            </div>
        </div>

        <div class="guide-card">
            <div class="guide-header" onclick="toggleGuide(this)">
                <strong>üìö Free Govt Study Resources</strong> <span>‚¨áÔ∏è</span>
            </div>
            <div class="guide-content">
                <p>‡§™‡•à‡§∏‡•á ‡§ï‡•Ä ‡§ï‡§Æ‡•Ä ‡§™‡•ù‡§æ‡§à ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ï‡§æ‡§µ‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§≠‡§æ‡§∞‡§§ ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§Ø‡•á ‡§´‡•ç‡§∞‡•Ä ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤‡•ç‡§∏ ‡§Ø‡•Ç‡•õ ‡§ï‡§∞‡•á‡§Ç:</p>
                <ul style="padding-left:20px; margin-top:10px;">
                    <li style="margin-bottom:8px;">
                        <strong>SWAYAM Portal:</strong><br>
                        IIT ‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§≤‡•á‡§ï‡•ç‡§ö‡§∞ ‡§´‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§<br>
                        <a href="https://swayam.gov.in/" target="_blank" style="color:var(--accent);">Visit Swayam</a>
                    </li>
                    <li style="margin-bottom:8px;">
                        <strong>NDLI (National Digital Library):</strong><br>
                        ‡§ï‡§∞‡•ã‡•ú‡•ã‡§Ç ‡§ï‡§ø‡§§‡§æ‡§¨‡•á‡§Ç ‡§î‡§∞ ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§´‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡•§<br>
                        <a href="https://ndl.iitkgp.ac.in/" target="_blank" style="color:var(--accent);">Visit Library</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="guide-card">
            <div class="guide-header" onclick="toggleGuide(this)">
                <strong>üß† Scientific Study Techniques</strong> <span>‚¨áÔ∏è</span>
            </div>
            <div class="guide-content">
                <p>‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§∏‡•ç‡§ü‡§°‡•Ä ‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§Æ ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü‡•§</p>
                <ul style="padding-left:20px; margin-top:10px;">
                    <li><strong>Pomodoro Technique:</strong> 25 ‡§Æ‡§ø‡§®‡§ü ‡§™‡•ù‡§æ‡§à + 5 ‡§Æ‡§ø‡§®‡§ü ‡§¨‡•ç‡§∞‡•á‡§ï‡•§ ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§á‡§∏‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡§æ ‡§π‡•à‡•§</li>
                    <li><strong>Feynman Technique:</strong> ‡§ü‡•â‡§™‡§ø‡§ï ‡§™‡•ù‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§î‡§∞ ‡§ï‡•ã (‡§Ø‡§æ ‡§ñ‡•Å‡§¶ ‡§ï‡•ã) ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§è‡§Ç‡•§</li>
                    <li><strong>Sleep is crucial:</strong> ‡§ú‡•ã ‡§™‡•ù‡§æ ‡§π‡•à ‡§â‡§∏‡•á ‡§≤‡•â‡§®‡•ç‡§ó-‡§ü‡§∞‡•ç‡§Æ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 7 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡•Ä ‡§®‡•Ä‡§Ç‡§¶ ‡•õ‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡•§</li>
                </ul>
            </div>
        </div>

      </div>
    </div>

    <div id="section-planner" class="hidden">
      <div class="glass-panel">
        <h2>ü§ñ AI Syllabus Planner</h2>
        <textarea id="aiSyllabus" class="input" rows="5" placeholder="Enter chapters separated by commas..."></textarea>
        <div style="display:flex; gap:10px; margin-bottom:15px;">
          <input type="date" id="aiDate" class="input">
          <button class="btn btn-primary" onclick="generatePlan()">Generate Plan</button>
        </div>
        <div id="aiResult" style="margin-top:20px;"></div>
        
        <div class="ad-slot">
             <span class="ad-label">Sponsored</span>
             <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-5520401672645952"
                  data-ad-slot="4459868531"
                  data-ad-format="auto"
                  data-full-width-responsive="true"></ins>
             <script>
                  (adsbygoogle = window.adsbygoogle || []).push({});
             </script>
        </div>
      </div>
    </div>

    <div id="section-notes" class="hidden">
      <div class="glass-panel" style="height:100%; display:flex; flex-direction:column;">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h2>üìù Smart Notes</h2>
          <button class="btn btn-ghost" onclick="downloadNotes()">üíæ Save</button>
        </div>
        
        <div class="math-toolbar">
            <button class="math-btn" onclick="insSym('‚àö')">‚àö</button>
            <button class="math-btn" onclick="insSym('Œ∏')">Œ∏</button>
            <button class="math-btn" onclick="insSym('œÄ')">œÄ</button>
            <button class="math-btn" onclick="insSym('¬≤')">x¬≤</button>
            <button class="math-btn" onclick="insSym('Œî')">Œî</button>
            <button class="math-btn" onclick="insSym('‚à´')">‚à´</button>
            <button class="math-btn" onclick="insSym('‚Üí')">‚Üí</button>
            <button class="math-btn" onclick="insSym('‚ùì')">‚ùì</button>
            <button class="math-btn" onclick="insSym('‚≠ê')">‚≠ê</button>
        </div>

        <textarea id="scratchpad" class="input" style="flex:1; resize:none; font-family:monospace; font-size:16px; line-height:1.5;" placeholder="Type here..."></textarea>
      </div>
    </div>

    <div id="section-settings" class="hidden">
      <div class="glass-panel">
        <h2>‚öôÔ∏è Settings</h2>
<div style="margin-top:20px; border:1px solid rgba(255,255,255,0.1); border-radius:12px; padding:12px; background:rgba(0,0,0,0.2);">
    <div onclick="toggleHelp()" style="display:flex; justify-content:space-between; align-items:center; cursor:pointer;">
        <span style="font-weight:bold;">‚ùì How to Use App</span>
        <span id="helpArrow">‚¨áÔ∏è</span>
    </div>
    
    <div id="helpContent" class="hidden" style="margin-top:15px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px; font-size:13px; color:var(--text-muted); line-height:1.6;">
        <p><strong>1. ‚úÖ Add Tasks:</strong> Dashboard ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç, ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§∏‡§Æ‡§Ø (Mins) ‡§≤‡§ø‡§ñ‡•á‡§Ç ‡§î‡§∞ 'Add' ‡§¶‡§¨‡§æ‡§è‡§Ç‡•§</p>
        <p><strong>2. üî• Start Focus:</strong> ‡§ü‡§æ‡§∏‡•ç‡§ï ‡§ï‡•á ‡§¨‡§ó‡§≤ ‡§Æ‡•á‡§Ç 'Focus' ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Ç‡•§ ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
        <p><strong>3. ü§ñ AI Planner:</strong> Planner ‡§ü‡•à‡§¨ ‡§Æ‡•á‡§Ç ‡§ö‡•à‡§™‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§î‡§∞ ‡§è‡§ó‡•ç‡§ú‡§æ‡§Æ ‡§°‡•á‡§ü ‡§°‡§æ‡§≤‡•á‡§Ç‡•§ AI ‡§™‡•ç‡§≤‡§æ‡§® ‡§¨‡§®‡§æ‡§è‡§ó‡§æ‡•§</p>
        <p><strong>4. üìù Scratchpad:</strong> ‡§Æ‡•à‡§• ‡§∏‡§ø‡§Æ‡•ç‡§¨‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§¨‡§®‡§æ‡§è‡§Ç‡•§ ‡§Ø‡§π ‡§ë‡§ü‡•ã-‡§∏‡•á‡§µ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§</p>
    </div>
</div>
        
        <div style="margin-top:20px;">
            <label>Sound & Effects</label>
            <div style="display:flex; gap:10px; margin-top:5px;">
                <button class="btn btn-ghost" id="btnSound" onclick="toggleSetting('sound')">üîä Sound: ON</button>
                <button class="btn btn-ghost" id="btnVibe" onclick="toggleSetting('vibration')">üì≥ Vibration: ON</button>
            </div>
        </div>

        <div style="margin-top:20px;">
          <label>Theme</label>
          <select id="themeSelect" class="input" onchange="changeTheme(this.value)">
            <option value="mint">Mint Fresh (Default)</option>
            <option value="sunset">Sunset Vibes</option>
          </select>
        </div>
        
        <div style="margin-top:20px;">
          <button class="btn" style="background:var(--danger); color:white;" onclick="hardReset()">Reset All Data</button>
        </div>
      </div>
    </div>

    <div class="footer">
    POWERED BY <span>ABHI</span> ‚Ä¢ Study Arc v3.1 <br>
    <div style="margin-top: 5px;">
        <a href="privacy.html" style="color: var(--text-muted); font-size: 11px; text-decoration: none;">Privacy Policy</a>
    </div>
</div>
  </main>
</div>

<script>
/* --- üß† CORE LOGIC (V3.1 - Simple & Ad Ready) --- */

// State
let profile = JSON.parse(localStorage.getItem('st_profile'));
let tasks = JSON.parse(localStorage.getItem('st_tasks') || '[]');
let streak = parseInt(localStorage.getItem('st_streak') || '0');
let lastStudyDate = localStorage.getItem('st_lastDate');
let notes = localStorage.getItem('st_notes') || '';
let theme = localStorage.getItem('st_theme') || 'mint';
let settings = JSON.parse(localStorage.getItem('st_settings') || '{"sound":true, "vibration":true}');
// FEATURE 4: HISTORY
let history = JSON.parse(localStorage.getItem('st_history') || '{}'); 

// Init
function init() {
  if(!profile) {
    document.getElementById('onboardingModal').classList.remove('hidden');
  } else {
    updateUI();
  }
  
  document.body.className = `theme-${theme}`;
  document.getElementById('themeSelect').value = theme;
  document.getElementById('scratchpad').value = notes;
  document.getElementById('dateDisplay').innerText = new Date().toLocaleDateString('en-IN', { weekday: 'long', month: 'long', day: 'numeric' });
  
  renderTasks();
  renderChart();
  updateSettingsUI();
  showSection('dashboard');
}

// Navigation
function showSection(id) {
  ['dashboard', 'planner', 'notes', 'settings', 'guide'].forEach(v => {
    document.getElementById(`section-${v}`).classList.add('hidden');
  });
  document.getElementById(`section-${id}`).classList.remove('hidden');
  // Highlight Sidebar
  document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
}

// Onboarding
function completeOnboarding() {
  const name = document.getElementById('obName').value;
  const exam = document.getElementById('obClass').value;
  if(name) {
    profile = { name, exam };
    localStorage.setItem('st_profile', JSON.stringify(profile));
    document.getElementById('onboardingModal').classList.add('hidden');
    updateUI();
  }
}

function updateUI() {
  if(profile) document.getElementById('userGreet').innerText = `Hello, ${profile.name}`;
  document.getElementById('streakDisplay').innerText = streak;
  
  // Calc Total Time
  let totalSecs = Object.values(history).reduce((a,b)=>a+b, 0);
  let hrs = (totalSecs/3600).toFixed(1);
  document.getElementById('totalFocusTime').innerText = `${hrs}h`;
}

// --- ‚ö° FOCUS ENGINE (SIMPLE MODE) ---
let timerInterval = null;
let endTime = null;
let currentSubject = '';
let wakeLock = null;

function startQuickFocus() {
    const hrs = parseInt(document.getElementById('quickHrs').value) || 0;
    const mins = parseInt(document.getElementById('quickMins').value) || 0;
    const subj = document.getElementById('quickSubject').value;
    
    // Feature 6: Validation
    if(hrs === 0 && mins === 0) { alert("Please set duration!"); return; }
    
    startFocusSession(subj, (hrs*60) + mins);
}

async function startFocusSession(subject, totalMins) {
    currentSubject = subject;
    const totalSecs = totalMins * 60;
    
    // Feature 5: Smart Date Logic
    endTime = Date.now() + (totalSecs * 1000);
    
    document.getElementById('focusOverlay').classList.add('active');
    document.getElementById('focusSubjectDisplay').innerText = subject;
    
    // Feature 8: Wake Lock
    try { wakeLock = await navigator.wakeLock.request('screen'); } catch(e){}

    updateTimerDisplay();
    timerInterval = setInterval(timerTick, 1000);
}

function timerTick() {
    const now = Date.now();
    const diff = endTime - now;
    
    if(diff <= 0) {
        finishFocus();
    } else {
        const h = Math.floor(diff / 3600000);
        const m = Math.floor((diff % 3600000) / 60000);
        const s = Math.floor((diff % 60000) / 1000);
        document.getElementById('focusTimerDisplay').innerText = 
            `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }
}

function updateTimerDisplay() {
    // Helper to allow initial set (00:00:00) if needed
}

function finishFocus() {
    clearInterval(timerInterval);
    
    // Feature 13: End Sound
    if(settings.sound) playBeep();
    // Feature 11: Vibration
    if(settings.vibration && navigator.vibrate) navigator.vibrate([500, 200, 500]);
    
    // Feature 15: Notification
    if(Notification.permission === 'granted') new Notification("Focus Session Complete! üéâ");
    else if(Notification.permission !== 'denied') Notification.requestPermission();

    alert("Session Complete! Great job! üéâ");
    
    // Save History (Approximate Logic)
    if(!history[currentSubject]) history[currentSubject] = 0;
    history[currentSubject] += 1800; // Adding mock 30 mins for demo simplicity
    
    localStorage.setItem('st_history', JSON.stringify(history));
    
    exitFocus();
    updateUI();
    renderChart();
}

function exitFocus() {
    clearInterval(timerInterval);
    if(wakeLock) wakeLock.release();
    document.getElementById('focusOverlay').classList.remove('active');
}
function toggleTimer() { alert("Pause coming soon!"); }

// --- üìä CHART ---
function renderChart() {
    const ctx = document.getElementById('subjectChart').getContext('2d');
    const labels = Object.keys(history);
    const data = Object.values(history).map(s => (s/3600).toFixed(1));
    
    if(window.myChart) window.myChart.destroy();
    window.myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: labels.length ? labels : ['No Data'],
            datasets: [{ data: data.length ? data : [1], backgroundColor: ['#34d399', '#38bdf8', '#fbbf24', '#ef4444'], borderWidth: 0 }]
        },
        options: { plugins: { legend: { display: false } }, responsive: true, maintainAspectRatio: false }
    });
}

// --- üìù NOTES ---
const sp = document.getElementById('scratchpad');
sp.addEventListener('input', () => localStorage.setItem('st_notes', sp.value));
function insSym(sym) { sp.value += sym; localStorage.setItem('st_notes', sp.value); }
function downloadNotes() {
    const blob = new Blob([sp.value], {type:'text/plain'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'notes.txt'; a.click();
}

// --- ‚ÑπÔ∏è GUIDE TOGGLE ---
function toggleGuide(el) {
    const content = el.nextElementSibling;
    content.classList.toggle('open');
    el.querySelector('span').innerText = content.classList.contains('open') ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è';
}

// --- TASKS ---
function toggleTaskForm() {
    const f = document.getElementById('addTaskForm');
    f.style.display = f.style.display === 'none' ? 'block' : 'none';
}
function addTask() {
    const name = document.getElementById('newTaskName').value;
    if(name) {
        tasks.unshift({ id: Date.now(), name, completed: false });
        localStorage.setItem('st_tasks', JSON.stringify(tasks));
        renderTasks();
        document.getElementById('newTaskName').value = '';
    }
}
function renderTasks() {
    const list = document.getElementById('taskListContainer');
    list.innerHTML = '';
    tasks.forEach(t => {
        list.innerHTML += `
        <div class="task-item" style="opacity:${t.completed?0.5:1}">
            <span style="text-decoration:${t.completed?'line-through':'none'}">${t.name}</span>
            <div style="display:flex; gap:5px;">
                <button class="btn btn-ghost" style="padding:5px;" onclick="toggleTask(${t.id})">‚úîÔ∏è</button>
                <button class="btn btn-ghost" style="color:var(--danger); padding:5px;" onclick="delTask(${t.id})">‚úñ</button>
            </div>
        </div>`;
    });
}
function toggleTask(id) {
    const t = tasks.find(x => x.id === id);
    t.completed = !t.completed;
    localStorage.setItem('st_tasks', JSON.stringify(tasks));
    renderTasks();
}
function delTask(id) {
    tasks = tasks.filter(x => x.id !== id);
    localStorage.setItem('st_tasks', JSON.stringify(tasks));
    renderTasks();
}

// --- ‚öôÔ∏è SETTINGS ---
function toggleSetting(key) {
    settings[key] = !settings[key];
    localStorage.setItem('st_settings', JSON.stringify(settings));
    updateSettingsUI();
}
function updateSettingsUI() {
    document.getElementById('btnSound').innerText = `üîä Sound: ${settings.sound ? 'ON' : 'OFF'}`;
    document.getElementById('btnVibe').innerText = `üì≥ Vibration: ${settings.vibration ? 'ON' : 'OFF'}`;
}
function changeTheme(val) {
    localStorage.setItem('st_theme', val);
    document.body.className = `theme-${val}`;
}
function hardReset() { if(confirm("Reset Everything?")) { localStorage.clear(); location.reload(); } }
// üëá How to Use Toggle Logic (Paste Here)
function toggleHelp() {
    const el = document.getElementById('helpContent');
    const arrow = document.getElementById('helpArrow');
    if (el.classList.contains('hidden')) {
        el.classList.remove('hidden');
        arrow.innerText = '‚¨ÜÔ∏è';
    } else {
        el.classList.add('hidden');
        arrow.innerText = '‚¨áÔ∏è';
    }
}

// Audio
function playBeep() {
    const a = new (window.AudioContext || window.webkitAudioContext)();
    const o = a.createOscillator();
    const g = a.createGain();
    o.connect(g); g.connect(a.destination);
    o.start(); g.gain.exponentialRampToValueAtTime(0.00001, a.currentTime + 1);
    o.stop(a.currentTime + 1);
}

// Planner Placeholder
function generatePlan() {
    const res = document.getElementById('aiResult');
    res.innerHTML = `<div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:10px;">üöÄ <strong>Plan Generated:</strong> Break down your chapters into 3 sessions daily.</div>`;
}

init();

// üëá SERVICE WORKER (OFFLINE MODE)
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => console.log('‚úÖ Service Worker Registered!', reg))
      .catch(err => console.log('‚ùå SW Failed:', err));
  });
}
</script>
</body>
</html>