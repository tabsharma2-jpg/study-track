<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Study Tracker</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='18' fill='%232575fc'/><text x='50' y='60' font-size='48' text-anchor='middle' fill='white' font-family='Poppins,Segoe UI,Arial'>ST</text></svg>'">

<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<link rel="stylesheet" href="style.css">
</head>

<body>
<div class="container" id="app">

  <!-- HEADER -->
  <div class="header">
    <div class="brand">
      <div class="logo">ST</div>
      <div>
        <div class="title" id="appTitle">Study Tracker</div>
        <div class="subtitle" id="appSub">Plan · Focus · Finish</div>
      </div>
    </div>

    <div class="actions">
      <div class="toggle small-muted" title="Toggle theme">
        <button class="btn" id="themeToggle">Dark</button>
      </div>

      <!-- Focus Button -->
      <button class="btn" id="openFocus">Focus</button>

      <!-- NEW INSTALL BUTTON -->
      <button class="btn" id="installBtn" style="display:none;">Install</button>
    </div>
  </div>

  <!-- GRID -->
  <div class="grid">

    <!-- LEFT PANEL -->
    <div class="left">

      <!-- USER CARD -->
      <div class="section" id="userCard">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:800;font-size:18px" id="userHello">Hello, Student</div>
            <div class="small-muted" id="userClassDisplay">Class / Exam</div>
          </div>
          <button class="btn" id="editProfileBtn">Edit</button>
        </div>
      </div>

      <!-- TASKS -->
      <div class="section">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">Tasks</h3>
          <div class="small-muted" id="taskSummary">0 tasks • 0 min</div>
        </div>

        <div class="taskForm" style="margin-top:12px">
          <input id="taskTitle" placeholder="Task name">
          <input id="taskHours" type="number" min="0" placeholder="hrs" style="width:80px">
          <input id="taskMins" type="number" min="0" placeholder="mins" style="width:80px">
          <select id="taskSub" style="min-width:120px">
            <option value="">Subject</option>
            <option>Math</option>
            <option>Physics</option>
            <option>Chemistry</option>
            <option>Biology</option>
            <option>General</option>
          </select>
          <button class="addBtn" id="addTaskBtn">Add</button>
        </div>

        <div id="tasksList" style="margin-top:12px"></div>
      </div>

      <!-- TIMETABLE -->
      <div class="section">
        <h3 style="margin:0">Quick Timetable</h3>
        <div class="small-muted" style="margin-top:6px">Click to add slot</div>
        <div id="miniTable" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px"></div>
      </div>

    </div>

    <!-- RIGHT PANEL -->
    <div class="right">
      <div class="widget">
        <h4 style="margin:0">Progress (last 7 days)</h4>
        <div class="chartWrap">
          <canvas id="progressChart"></canvas>
        </div>
      </div>

      <div class="widget">
        <h4 style="margin:0">Focus</h4>
        <div class="small-muted" style="margin-top:6px">Quick start Pomodoro</div>
        <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
          <input id="quickFocusMins" type="number" value="25" style="width:70px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:white">
          <button class="addBtn" id="quickStartFocus">Start</button>
        </div>
      </div>

      <div class="widget">
        <h4 style="margin:0">Today</h4>
        <div class="small-muted" style="margin-top:6px" id="todaySummary">No study yet</div>
      </div>
    </div>
  </div>

  <div class="powered">POWERED BY ABHI SARSWAT</div>
</div>

<!-- WELCOME OVERLAY -->
<div id="welcomeOverlay">
  <div class="welcomeCard" id="welcomeCard">
    <div class="w-left">
      <h1 style="margin:0 0 6px 0">Welcome to Study Tracker</h1>
      <p class="small">Enter your name & class once — we will save it locally.</p>

      <input class="input" id="nameIn" placeholder="Your name">
      <input class="input" id="classIn" placeholder="Class / Exam (e.g., Class 12 / JEE)">
      <div style="display:flex;gap:8px;margin-top:12px">
        <button class="addBtn" id="saveProfileBtn">Start</button>
        <button class="btn" id="skipBtn">Skip</button>
      </div>

      <p class="small-muted" style="margin-top:10px">Tip: Use the Focus panel to run Pomodoro sessions and track minutes.</p>
    </div>

    <div class="w-right">
      <h3 style="margin-top:0">Existing Settings</h3>
      <div id="existingInfo" style="margin-top:10px;color:var(--accent-2)">No profile yet</div>

      <div style="margin-top:16px">
        <h4 style="margin:6px 0 8px 0">Shortcuts</h4>
        <div class="small-muted">• Add tasks quickly from left panel</div>
        <div class="small-muted">• Start quick focus from right</div>
      </div>
    </div>
  </div>
</div>

<!-- FOCUS MODAL -->
<div id="focusModal" class="hidden">
  <div class="focusCard">
    <h3 id="focusTitle">Focus Session</h3>
    <div id="focusTimer" class="focusTime">25:00</div>
    <div style="display:flex;gap:8px;justify-content:center">
      <button class="btn primary" id="focusStartBtn">Start</button>
      <button class="btn" id="focusPauseBtn">Pause</button>
      <button class="btn" id="focusCloseBtn">Close</button>
    </div>
  </div>
</div>

<canvas id="confettiCanvas" style="position:fixed;inset:0;pointer-events:none;z-index:80"></canvas>

<script src="script.js"></script>
<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
</script>

</body>
</html>
